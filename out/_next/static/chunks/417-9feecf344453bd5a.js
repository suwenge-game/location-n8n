"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[417],{3417:(e,t,r)=>{r.r(t),r.d(t,{CookieConsent:()=>i,CookiePreferencesTrigger:()=>u});var a=r(5155),n=r(2115);let l="autoflow.cookie-consent",s="autoflow:cookie-consent-open",o={necessary:!0,analytics:!1,marketing:!1,updatedAt:""};function d(){try{let e=window.localStorage.getItem(l);if(!e)return null;let t=JSON.parse(e);if(!t||!0!==t.necessary)return null;return{necessary:!0,analytics:!!t.analytics,marketing:!!t.marketing,updatedAt:"string"==typeof t.updatedAt?t.updatedAt:""}}catch(e){return console.warn("无法读取 Cookie 同意状态：",e),null}}function i(){let[e,t]=(0,n.useState)(o),[r,i]=(0,n.useState)(!1),[u,c]=(0,n.useState)(!1),[x,m]=(0,n.useState)({analytics:o.analytics,marketing:o.marketing});(0,n.useEffect)(()=>{let e=d();e?(t(e),i(!1)):i(!0)},[]),(0,n.useEffect)(()=>{function t(){m({analytics:e.analytics,marketing:e.marketing}),c(!0),i(!1)}return window.addEventListener(s,t),()=>{window.removeEventListener(s,t)}},[e]),(0,n.useEffect)(()=>{if(!u)return;let e=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=e}},[u]);let k=(0,n.useCallback)(e=>{let r={necessary:!0,analytics:e.analytics,marketing:e.marketing,updatedAt:new Date().toISOString()};t(r);try{window.localStorage.setItem(l,JSON.stringify(r)),window.dispatchEvent(new CustomEvent("autoflow:cookie-consent-change",{detail:r}))}catch(e){console.warn("无法写入 Cookie 同意状态：",e)}c(!1),i(!1)},[]),b=(0,n.useCallback)(()=>{k({analytics:!0,marketing:!0})},[k]),h=(0,n.useCallback)(()=>{k({analytics:!1,marketing:!1})},[k]),p=(0,n.useCallback)(()=>{m({analytics:e.analytics,marketing:e.marketing}),c(!0)},[e.analytics,e.marketing]),g=(0,n.useCallback)(()=>{c(!1),d()||i(!0)},[]),f=(0,n.useMemo)(()=>r&&!u,[r,u]);return(0,a.jsxs)(a.Fragment,{children:[f?(0,a.jsx)("div",{className:"fixed inset-x-0 bottom-0 z-40 px-4 pb-4 sm:px-6 sm:pb-6",children:(0,a.jsx)("div",{className:"mx-auto max-w-3xl rounded-2xl border border-neutral-200 bg-white/95 p-6 shadow-xl backdrop-blur dark:border-neutral-800 dark:bg-neutral-900/95",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-neutral-900 dark:text-white",children:"Cookie 使用说明"}),(0,a.jsx)("p",{className:"text-sm leading-relaxed text-neutral-600 dark:text-neutral-300",children:"我们会使用必要的 Cookie 保证站点正常运行；若您同意，也会使用分析 Cookie 帮助我们了解内容表现。您可以随时在偏好设置中修改选择。"})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-end",children:[(0,a.jsx)("button",{type:"button",onClick:h,className:"rounded-lg border border-neutral-300 px-4 py-2 text-sm font-medium text-neutral-700 transition-colors hover:border-neutral-400 hover:text-neutral-900 dark:border-neutral-700 dark:text-neutral-200 dark:hover:border-neutral-600",children:"仅使用必要 Cookie"}),(0,a.jsx)("button",{type:"button",onClick:p,className:"rounded-lg border border-transparent px-4 py-2 text-sm font-medium text-neutral-700 underline-offset-4 transition-colors hover:text-neutral-900 dark:text-neutral-200 dark:hover:text-white",children:"设置偏好"}),(0,a.jsx)("button",{type:"button",onClick:b,className:"rounded-lg bg-neutral-900 px-4 py-2 text-sm font-semibold text-white transition-colors hover:bg-neutral-800 dark:bg-white dark:text-neutral-900 dark:hover:bg-neutral-200",children:"同意全部 Cookie"})]})]})})}):null,u?(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4 py-6",children:[(0,a.jsx)("div",{"aria-hidden":"true",className:"absolute inset-0 bg-neutral-900/40 backdrop-blur",onClick:g}),(0,a.jsxs)("div",{role:"dialog","aria-modal":"true","aria-labelledby":"cookie-preferences-title",className:"relative z-10 w-full max-w-xl rounded-2xl border border-neutral-200 bg-white p-6 shadow-2xl dark:border-neutral-800 dark:bg-neutral-900",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h2",{id:"cookie-preferences-title",className:"text-lg font-semibold text-neutral-900 dark:text-white",children:"Cookie 偏好设置"}),(0,a.jsx)("p",{className:"text-sm leading-relaxed text-neutral-600 dark:text-neutral-300",children:"根据类别选择是否允许我们收集额外的数据。必要 Cookie 将始终启用，以保障站点的基础功能。"})]}),(0,a.jsx)("button",{type:"button",onClick:g,className:"rounded-full border border-transparent p-1 text-neutral-500 transition-colors hover:text-neutral-900 dark:text-neutral-400 dark:hover:text-white","aria-label":"关闭",children:(0,a.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",className:"h-5 w-5",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 6l12 12M18 6L6 18"})})})]}),(0,a.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,a.jsx)("section",{className:"rounded-xl border border-neutral-200 bg-neutral-50/80 p-4 dark:border-neutral-700 dark:bg-neutral-800/60",children:(0,a.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-neutral-800 dark:text-neutral-100",children:"必要 Cookie"}),(0,a.jsx)("p",{className:"mt-1 text-xs leading-relaxed text-neutral-600 dark:text-neutral-300/80",children:"用于记住登录状态、保存您的隐私设置等关键站点功能，无法被关闭。"})]}),(0,a.jsx)("span",{className:"rounded-full bg-neutral-200 px-3 py-1 text-xs font-medium text-neutral-700 dark:bg-neutral-700/60 dark:text-neutral-200",children:"始终启用"})]})}),(0,a.jsxs)("label",{className:"flex items-start justify-between gap-4 rounded-xl border border-neutral-200 p-4 transition-colors hover:border-neutral-300 dark:border-neutral-700 dark:hover:border-neutral-600",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-neutral-800 dark:text-neutral-100",children:"分析 Cookie"}),(0,a.jsx)("p",{className:"text-xs leading-relaxed text-neutral-600 dark:text-neutral-300/80",children:"帮助我们统计页面浏览量与事件，了解不同内容的表现，优化产品体验。"})]}),(0,a.jsx)("input",{type:"checkbox",checked:x.analytics,onChange:e=>m(t=>({...t,analytics:e.target.checked})),className:"mt-1 h-4 w-4 rounded border-neutral-300 text-neutral-900 focus:ring-neutral-900 dark:border-neutral-600 dark:bg-neutral-800"})]}),(0,a.jsxs)("label",{className:"flex items-start justify-between gap-4 rounded-xl border border-neutral-200 p-4 transition-colors hover:border-neutral-300 dark:border-neutral-700 dark:hover:border-neutral-600",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-neutral-800 dark:text-neutral-100",children:"营销 Cookie"}),(0,a.jsx)("p",{className:"text-xs leading-relaxed text-neutral-600 dark:text-neutral-300/80",children:"用于个性化推荐和活动通知，目前仅在订阅邮件中使用，帮助我们发送与您更相关的更新。"})]}),(0,a.jsx)("input",{type:"checkbox",checked:x.marketing,onChange:e=>m(t=>({...t,marketing:e.target.checked})),className:"mt-1 h-4 w-4 rounded border-neutral-300 text-neutral-900 focus:ring-neutral-900 dark:border-neutral-600 dark:bg-neutral-800"})]})]}),(0,a.jsxs)("div",{className:"mt-6 flex flex-col-reverse gap-3 sm:flex-row sm:justify-end",children:[(0,a.jsx)("button",{type:"button",onClick:g,className:"rounded-lg border border-neutral-300 px-4 py-2 text-sm font-medium text-neutral-700 transition-colors hover:border-neutral-400 hover:text-neutral-900 dark:border-neutral-700 dark:text-neutral-200 dark:hover:border-neutral-600",children:"取消"}),(0,a.jsx)("button",{type:"button",onClick:()=>k(x),className:"rounded-lg bg-neutral-900 px-4 py-2 text-sm font-semibold text-white transition-colors hover:bg-neutral-800 dark:bg-white dark:text-neutral-900 dark:hover:bg-neutral-200",children:"保存偏好"})]})]})]}):null]})}function u(e){let{className:t,children:r}=e,l=(0,n.useCallback)(()=>{window.dispatchEvent(new Event(s))},[]);return(0,a.jsx)("button",{type:"button",onClick:l,className:null!=t?t:"text-sm font-medium text-neutral-600 underline underline-offset-4 transition-colors hover:text-neutral-900 dark:text-neutral-300 dark:hover:text-white",children:null!=r?r:"管理 Cookie 偏好"})}}}]);